from HW1.data_gen import DataSet
import numpy as np


def generate_target(data_set):

    """A method used to set the target vector for the linear regression.

    Target vector i is set to -1 if point i dot f is negative (or zero) otherwise set to +1.
    Params: DataSet
    Return: Target vector as an numpy array (length == number points in DataSet)
    """
    target_vector = np.empty(data_set.size, dtype=float)
    for index, bool in enumerate(data_set.bools):
        if bool:
            target_vector[index] = 1
        else:
            target_vector[index] = -1

    return target_vector


def linear_regression(data_set, target):

    """
    A method to computed the least squares linear regression for classification.

    Params: DataSet object, target vector.
    Return: g calculated using linear regression.
    """
    pseudo_inverse = np.linalg.pinv(data_set.points)
    w = np.dot(pseudo_inverse, target)

    return w


def error_in(data_set, g):
    """Method to determine the in sample error of the linear regression classification method.

    Params: DataSet object, and the vector for output from linear_regression method
    Return: The in sample error probability
    """
    error = 0.0
    for point in data_set.points:
        if not data_set.compare(point, g):
            error += 1
    return error / data_set.size


data_set = DataSet(100)
g = linear_regression(data_set, generate_target(data_set))
print(error_in(data_set, g))
data_set.visualize_hypoth(g)
